<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Daftar Hutang Piutang</title>
    <style>
      body {
        font-family: sans-serif;
        margin: 0;
        padding: 0;
        height: 100vh; /* Ensure full height */
        overflow: hidden; /* Remove any scroll caused by extra spacing */
        background: #f9f9f9;
        display: flex;
        justify-content: center;
        align-items: flex-start; /* Align content to the top-left */
        flex-direction: column;
      }

      .container {
        height: 100%; /* Ensure container takes full height */
        width: 100%;
        max-width: 800px;
        background: white;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        border-radius: 8px;
        overflow: hidden;
        margin: 0 auto; /* Remove top and bottom margin */
        display: flex;
        flex-direction: column;
        justify-content: space-between; /* Distribute content evenly */
      }

      .balance-container {
        padding: 1rem;
        background: white;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        border-radius: 8px;
        width: 100%;
        max-width: 800px;
        text-align: left; /* Align text to the left */
        margin-top: 1rem; /* Add spacing between balance and other content */
      }

      .header-container {
        width: 100%;
        max-width: 800px;
        margin: 0 auto;
        background: #333;
        color: white;
        font-size: 1.5rem;
        font-weight: bold;
        text-align: center;
        padding: 1rem 0;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        border-radius: 8px 8px 0 0; /* Rounded corners for the top */
      }

      .tabs {
        display: flex;
        justify-content: center;
        background: #eee;
        margin: 0; /* Remove all margin */
        padding: 0; /* Remove all padding */
        position: relative; /* Ensure proper positioning */
        top: 0; /* Align directly below header */
      }

      .tabs button {
        flex: 1;
        padding: 1rem;
        border: none;
        background: #eee;
        cursor: pointer;
        font-weight: bold;
      }

      .tabs button.active {
        background: #ddd;
        border-bottom: 2px solid #333;
      }

      .tab-content {
        padding: 1rem;
        padding-top: 0;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 2rem;
        table-layout: fixed; /* Ensure consistent column widths */
      }

      th,
      td {
        border: 1px solid #ccc;
        padding: 0.5rem;
        text-align: left;
        width: 33%; /* Set equal width for all columns */
      }

      img.bukti {
        width: 50px;
        height: auto;
        cursor: pointer;
      }

      .scrollable-table {
        max-height: 200px;
        overflow-y: auto;
        display: block;
      }

      .scrollable-table table {
        width: 100%;
        border-collapse: collapse;
      }

      .scrollable-table th,
      .scrollable-table td {
        border: 1px solid #ccc;
        padding: 0.5rem;
        text-align: left;
      }
    </style>
  </head>
  <body>
    <header class="header-container">Daftar Hutang Piutang</header>

    <div class="container">
      <div class="tabs">
        <button class="tab-button active" onclick="showTab('dollar')">
          Hutang Dolar
        </button>
        <button class="tab-button" onclick="showTab('rupiah')">
          Hutang Rupiah
        </button>
      </div>
      <div class="tab-content" id="dollar">
        <h3>Pinjaman (USD)</h3>
        <table class="loans">
          <thead>
            <tr>
              <th>Tanggal</th>
              <th>Nilai</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
        <h3>Pembayaran (USD)</h3>
        <div class="scrollable-table">
          <table class="payments">
            <thead>
              <tr>
                <th>Tanggal</th>
                <th>Nilai</th>
                <th>Bukti Bayar</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
      <div class="tab-content" id="rupiah" style="display: none">
        <h3>Pinjaman (IDR)</h3>
        <table class="loans">
          <thead>
            <tr>
              <th>Tanggal</th>
              <th>Nilai</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
        <h3>Pembayaran (IDR)</h3>
        <div class="scrollable-table">
          <table class="payments">
            <thead>
              <tr>
                <th>Tanggal</th>
                <th>Nilai</th>
                <th>Bukti Bayar</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>

    <script>
      function showTab(tabId) {
        document
          .querySelectorAll(".tab-content")
          .forEach((el) => (el.style.display = "none"));
        document.getElementById(tabId).style.display = "block";
        document
          .querySelectorAll(".tab-button")
          .forEach((btn) => btn.classList.remove("active"));
        const activeButton = Array.from(
          document.querySelectorAll(".tab-button")
        ).find((btn) =>
          btn.textContent.includes(tabId === "dollar" ? "Dolar" : "Rupiah")
        );
        activeButton.classList.add("active");
      }

      const data = {
        dollar: {
          loans: [
            { date: "2024-01-10", amount: 100 },
            { date: "2024-02-15", amount: 250 },
          ],
          payments: [
            { date: "2024-03-01", amount: 50, proofUrl: "assets/gambar1.jpg" },
            { date: "2024-04-05", amount: 100, proofUrl: "assets/gambar2.jpg" },
            { date: "2024-03-01", amount: 50, proofUrl: "assets/gambar1.jpg" },
            { date: "2024-04-05", amount: 100, proofUrl: "assets/gambar2.jpg" },
            { date: "2024-03-01", amount: 50, proofUrl: "assets/gambar1.jpg" },
            { date: "2024-04-05", amount: 100, proofUrl: "assets/gambar2.jpg" },
            { date: "2024-03-01", amount: 50, proofUrl: "assets/gambar1.jpg" },
            { date: "2024-04-05", amount: 100, proofUrl: "assets/gambar2.jpg" },
          ],
        },
        rupiah: {
          loans: [
            { date: "2024-01-12", amount: 1000000 },
            { date: "2024-02-20", amount: 2500000 },
          ],
          payments: [
            {
              date: "2024-03-02",
              amount: 500000,
              proofUrl: "assets/gambar1.jpg",
            },
            {
              date: "2024-04-07",
              amount: 1000000,
              proofUrl: "assets/gambar2.jpg",
            },
          ],
        },
      };

      function formatDateToIndonesian(dateString) {
        const options = { year: "numeric", month: "long", day: "numeric" };
        return new Date(dateString).toLocaleDateString("id-ID", options);
      }

      function populateTable(currency) {
        const loansTable = document.querySelector(`#${currency} .loans tbody`);
        const paymentsTable = document.querySelector(
          `#${currency} .payments tbody`
        );

        loansTable.innerHTML = data[currency].loans
          .map(
            (loan) => `
              <tr>
                <td>${formatDateToIndonesian(loan.date)}</td>
                <td>${currency === "dollar" ? "$" : "Rp"} ${
              currency === "dollar"
                ? loan.amount
                : loan.amount.toLocaleString("id-ID")
            }</td>
              </tr>
            `
          )
          .join("");

        paymentsTable.innerHTML = data[currency].payments
          .map(
            (payment) => `
              <tr>
                <td>${formatDateToIndonesian(payment.date)}</td>
                <td>${currency === "dollar" ? "$" : "Rp"} ${
              currency === "dollar"
                ? payment.amount
                : payment.amount.toLocaleString("id-ID")
            }</td>
                <td><img class="bukti" src="${
                  payment.proofUrl
                }" alt="Bukti Pembayaran" /></td>
              </tr>
            `
          )
          .join("");
      }

      function calculateBalance(currency) {
        const loansTotal = data[currency].loans.reduce(
          (sum, loan) => sum + loan.amount,
          0
        );
        const paymentsTotal = data[currency].payments.reduce(
          (sum, payment) => sum + payment.amount,
          0
        );
        return loansTotal - paymentsTotal;
      }

      function displayBalances() {
        const dollarBalance = calculateBalance("dollar");
        const rupiahBalance = calculateBalance("rupiah");

        const balanceContainer = document.createElement("div");
        balanceContainer.className = "balance-container";
        balanceContainer.innerHTML = `
          <h3>Saldo Akhir</h3>
          <p>Saldo Hutang Dolar: $${dollarBalance}</p>
          <p>Saldo Hutang Rupiah: Rp ${rupiahBalance.toLocaleString(
            "id-ID"
          )}</p>
        `;

        const container = document.querySelector(".container");
        container.appendChild(balanceContainer);
      }

      function showFullScreenImage(src) {
        const overlay = document.createElement("div");
        overlay.style.position = "fixed";
        overlay.style.top = "0";
        overlay.style.left = "0";
        overlay.style.width = "100%";
        overlay.style.height = "100%";
        overlay.style.backgroundColor = "rgba(0, 0, 0, 0.8)";
        overlay.style.display = "flex";
        overlay.style.justifyContent = "center";
        overlay.style.alignItems = "center";
        overlay.style.zIndex = "1000";

        const img = document.createElement("img");
        img.src = src;
        img.style.maxWidth = "90%";
        img.style.maxHeight = "90%";
        img.style.boxShadow = "0 0 10px white";
        img.style.zIndex = "1001";
        img.addEventListener("click", (e) => e.stopPropagation());

        const closeButton = document.createElement("button");
        closeButton.textContent = "Close";
        closeButton.style.position = "absolute";
        closeButton.style.top = "20px";
        closeButton.style.right = "20px";
        closeButton.style.padding = "10px 20px";
        closeButton.style.backgroundColor = "red";
        closeButton.style.color = "white";
        closeButton.style.border = "none";
        closeButton.style.cursor = "pointer";
        closeButton.style.fontSize = "16px";
        closeButton.style.zIndex = "1002";
        closeButton.addEventListener("click", (e) => {
          e.stopPropagation();
          document.body.removeChild(overlay);
        });

        overlay.appendChild(img);
        overlay.appendChild(closeButton);
        overlay.addEventListener("click", () =>
          document.body.removeChild(overlay)
        );
        document.body.appendChild(overlay);
      }

      function attachImageClickHandlers() {
        document.querySelectorAll("img.bukti").forEach((img) => {
          img.style.cursor = "pointer";
          img.onclick = () => showFullScreenImage(img.src);
        });
      }

      window.onload = () => {
        populateTable("dollar");
        populateTable("rupiah");
        attachImageClickHandlers();
        displayBalances();
      };
    </script>
  </body>
</html>
